<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>NDEMLP Login</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@400;500;700;900&amp;display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#000080",
                        "accent": "#FF9933",
                        "background-light": "#F8F9FA",
                        "background-dark": "#101922",
                        "text-light": "#212529",
                        "text-dark": "#F8F9FA",
                        "success": "#138808",
                        "error": "#D8000C"
                    },
                    fontFamily: {
                        "display": ["Public Sans", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.25rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
    <style>
        body {
            font-family: 'Public Sans', sans-serif;
        }
    </style>
</head>

<body class="bg-background-light dark:bg-background-dark font-display text-text-light dark:text-text-dark">
    <div class="relative flex h-auto min-h-screen w-full flex-col group/design-root overflow-x-hidden">
        <div class="layout-container flex h-full grow flex-col">
            <header
                class="flex items-center justify-between whitespace-nowrap px-6 sm:px-10 py-4 absolute top-0 left-0 right-0 z-10">
                <div class="flex items-center gap-3 text-text-light dark:text-text-dark">
                    <div class="w-8 h-8">
                        <svg fill="currentColor" viewbox="0 0 50 50" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M25,5.19A19.81,19.81,0,1,0,44.81,25,19.83,19.83,0,0,0,25,5.19ZM11.69,25a13.31,13.31,0,1,1,22,11.23A13.23,13.23,0,0,1,11.69,25Z">
                            </path>
                            <path d="M25,12.44a1,1,0,0,0-1,1v13.1a1,1,0,0,0,2,0V13.44A1,1,0,0,0,25,12.44Z"></path>
                            <path d="M25,30.31a1,1,0,0,0-1,1v5.25a1,1,0,0,0,2,0V31.31A1,1,0,0,0,25,30.31Z"></path>
                            <path
                                d="M25,19.19a5.81,5.81,0,1,0,5.81,5.81A5.81,5.81,0,0,0,25,19.19Zm0,9.62A3.81,3.81,0,1,1,28.81,25,3.81,3.81,0,0,1,25,28.81Z">
                            </path>
                        </svg>
                    </div>
                    <h2 class="text-lg font-bold tracking-tight">NDEMLP</h2>
                </div>
                <button
                    class="flex min-w-[84px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-white dark:bg-background-dark border border-gray-300 dark:border-gray-700 text-text-light dark:text-text-dark text-sm font-bold leading-normal tracking-[0.015em]">
                    <span class="truncate">English/Hindi</span>
                </button>
            </header>
            <main class="flex flex-1 w-full">
                <div class="flex w-full min-h-screen">
                    <div
                        class="hidden lg:flex flex-col justify-center items-start w-1/2 bg-gray-100 dark:bg-gray-900/50 p-12 relative overflow-hidden">
                        <div class="w-full h-full bg-center bg-no-repeat bg-cover aspect-auto"
                            data-alt="An abstract illustration of interconnected digital nodes representing a modern learning network in India"
                            style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuBRAajQTMhoAINRYSwVSRxsLcfS3FKEjrD1verCNzfdzbqXOVZDnCr_jvwZOyqS33sl9-m-EQu0YOROshUz8Z-9yn6LeLTlm8HyseU5vcGjN7rK58QPFxPuOaGTtr-hSevurv2LS7pFpCwFwWsr3eDQoJhmTSfGk1tsRbFIxj8-4kUzmK8cOYgLnR01WEMEbDwR4_Y3fKRLPlijG2hasQO3KLKFyA6IFyGIZy63QBvR_brSNsvwlWAZlP31Ix3jA7niOxFYauq3aFGk'); opacity: 0.1;">
                        </div>
                        <div class="absolute inset-0 p-12 flex flex-col justify-center">
                            <h1
                                class="text-4xl font-black leading-tight tracking-tight text-text-light dark:text-text-dark mb-4">
                                National Digital Education Management and Learning Platform</h1>
                            <p class="text-lg text-gray-600 dark:text-gray-400">Empowering India's Future Through
                                Digital Education.</p>
                        </div>
                    </div>
                    <div class="w-full lg:w-1/2 flex items-center justify-center p-6 sm:p-12">
                        <div class="flex flex-col w-full max-w-md">
                            <div class="flex flex-col gap-3 mb-8">
                                <p
                                    class="text-text-light dark:text-text-dark text-4xl font-black leading-tight tracking-[-0.033em]">
                                    Sign In to Your Account</p>
                                <p class="text-gray-500 dark:text-gray-400 text-base font-normal leading-normal">Enter
                                    your credentials to access your dashboard</p>
                            </div>
                            <div id="error-message" class="hidden mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg"></div>
                            <form id="loginForm" class="flex flex-col gap-6">
                                <label class="flex flex-col w-full">
                                    <p
                                        class="text-text-light dark:text-text-dark text-base font-medium leading-normal pb-2">
                                        Username</p>
                                    <input id="username"
                                        class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-text-light dark:text-text-dark focus:outline-0 focus:ring-2 focus:ring-primary/50 border border-gray-300 dark:border-gray-700 bg-background-light dark:bg-gray-800 focus:border-primary h-14 placeholder:text-gray-500 dark:placeholder:text-gray-500 p-[15px] text-base font-normal leading-normal"
                                        placeholder="Enter your username" type="text" value="" required />
                                </label>
                                <label class="flex flex-col w-full">
                                    <div class="flex justify-between items-center pb-2">
                                        <p
                                            class="text-text-light dark:text-text-dark text-base font-medium leading-normal">
                                            Password</p>
                                        <a class="text-sm font-medium text-primary hover:underline" href="#">Forgot
                                            Password?</a>
                                    </div>
                                    <div class="relative w-full">
                                        <input id="password"
                                            class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-text-light dark:text-text-dark focus:outline-0 focus:ring-2 focus:ring-primary/50 border border-gray-300 dark:border-gray-700 bg-background-light dark:bg-gray-800 focus:border-primary h-14 placeholder:text-gray-500 dark:placeholder:text-gray-500 p-[15px] pr-12 text-base font-normal leading-normal"
                                            placeholder="Enter your password" type="password" value="" required />
                                        <button id="togglePassword"
                                            class="absolute inset-y-0 right-0 flex items-center pr-4 text-gray-500 dark:text-gray-400"
                                            type="button">
                                            <span class="material-symbols-outlined">visibility</span>
                                        </button>
                                    </div>
                                </label>
                                <button type="submit" id="loginBtn"
                                    class="flex min-w-[84px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-14 px-4 bg-primary text-white text-base font-bold leading-normal tracking-[0.015em] hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary">
                                    <span class="truncate">Login</span>
                                </button>
                            </form>
                            
                            <!-- Demo Credentials -->
                            <div class="mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg">
                                <h3 class="text-sm font-semibold text-blue-800 dark:text-blue-200 mb-2">Demo Credentials:</h3>
                                <div class="text-xs text-blue-700 dark:text-blue-300 space-y-1">
                                    <div><strong>Admin:</strong> admin / admin123</div>
                                    <div><strong>Teacher:</strong> teacher1 / teacher123</div>
                                    <div><strong>Student:</strong> student1 / student123</div>
                                </div>
                            </div>
                            <footer
                                class="mt-10 pt-6 border-t border-gray-200 dark:border-gray-800 text-center text-sm text-gray-500 dark:text-gray-400">
                                <div class="flex items-center justify-center gap-2 mb-4">
                                    <span class="material-symbols-outlined text-base">lock</span>
                                    <span>Secured by National Informatics Centre (NIC)</span>
                                </div>
                                <div class="flex justify-center gap-x-4">
                                    <a class="hover:underline" href="#">Help</a>
                                    <span>Â·</span>
                                    <a class="hover:underline" href="#">Privacy Policy</a>
                                </div>
                            </footer>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    <script>
        // Toggle password visibility
        document.getElementById('togglePassword').addEventListener('click', function() {
            const passwordInput = document.getElementById('password');
            const icon = this.querySelector('.material-symbols-outlined');
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                icon.textContent = 'visibility_off';
            } else {
                passwordInput.type = 'password';
                icon.textContent = 'visibility';
            }
        });

        // Handle login form submission
        document.getElementById('loginForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const errorDiv = document.getElementById('error-message');
            const loginBtn = document.getElementById('loginBtn');
            
            // Clear previous errors
            errorDiv.classList.add('hidden');
            
            // Show loading state
            loginBtn.disabled = true;
            loginBtn.innerHTML = '<span class="truncate">Logging in...</span>';
            
            try {
                const response = await fetch('http://localhost:5000/api/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ username, password })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    // Store tokens
                    localStorage.setItem('accessToken', data.accessToken);
                    localStorage.setItem('refreshToken', data.refreshToken);
                    localStorage.setItem('user', JSON.stringify(data.user));
                    
                    // Redirect based on role
                    switch(data.user.role) {
                        case 'admin':
                            window.location.href = './frontend/admin/admin-dashboard.html';
                            break;
                        case 'teacher':
                            window.location.href = './frontend/teacher/teacher-dashboard.html';
                            break;
                        case 'student':
                            window.location.href = './frontend/students/student.html';
                            break;
                        default:
                            window.location.href = './frontend/admin/admin-dashboard.html';
                    }
                } else {
                    // Show error message
                    errorDiv.textContent = data.message || 'Login failed. Please try again.';
                    errorDiv.classList.remove('hidden');
                }
            } catch (error) {
                console.error('Login error:', error);
                errorDiv.textContent = 'Network error. Please check if the server is running.';
                errorDiv.classList.remove('hidden');
            } finally {
                // Reset button state
                loginBtn.disabled = false;
                loginBtn.innerHTML = '<span class="truncate">Login</span>';
            }
        });
    </script>
</body>

</html>